# A3-01: Create JWT Validator Service

> **Summary:** Create a service to validate JWT tokens using HS256 algorithm with shared secret, matching the TypeScript server's validation logic.

[← Back to Phase 3](README.md) | [Phase Document](../PHASE-3-AUTH.md)

---

**Priority:** P0  
**Estimate:** 6 hours  
**Dependencies:** P2-02

## Description

Create a service to validate JWT tokens using the same algorithm as the TypeScript server (HS256 with shared secret).

## Tasks

1. Create `IJwtValidator.cs` interface
2. Create `JwtValidator.cs` implementation
3. Support HS256 algorithm
4. Validate token claims (iss, aud, exp, iat)
5. Extract permissions from token

## Token Structure

```csharp
public class TokenPayload
{
    public string Sub { get; set; } = null!;    // User ID
    public string ClientId { get; set; } = null!;
    public string Iss { get; set; } = null!;     // Issuer
    public string Aud { get; set; } = null!;     // Audience
    public long Exp { get; set; }                // Expiration (Unix)
    public long Iat { get; set; }                // Issued at (Unix)
    public string[] Permissions { get; set; } = Array.Empty<string>();
}
```

## Acceptance Criteria

- [ ] Valid tokens return TokenPayload
- [ ] Invalid tokens return null
- [ ] Expired tokens rejected
- [ ] Issuer validated when configured
- [ ] Audience validated when configured
- [ ] Permissions extracted correctly

---

**Status:** ⬜ Not Started
