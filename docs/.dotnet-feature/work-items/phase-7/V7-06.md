# V7-06: Create SDK Compatibility Tests

> **Summary:** Verify the .NET server works with the production SDK using binary protocol for document sync, awareness, and reconnection scenarios.

[← Back to Phase 7](README.md) | [Phase Document](../PHASE-7-TESTING.md)

---

**Priority:** P0  
**Estimate:** 4 hours  
**Dependencies:** V7-02

## Description

Verify the .NET server works with the production SDK (binary protocol).

## Test Scenarios

1. SDK connects to .NET server
2. Document sync works end-to-end
3. Awareness updates work
4. Reconnection works
5. All SDK features functional

## Test Implementation

```typescript
// tests/sdk/dotnet-server-compat.test.ts
import { SyncKitClient, Document } from '@synckit/sdk';

describe('SDK with .NET Server', () => {
  let client: SyncKitClient;
  
  beforeAll(async () => {
    client = new SyncKitClient({
      serverUrl: process.env.SYNCKIT_SERVER_URL!,
      token: createTestToken(),
    });
    await client.connect();
  });

  test('document sync roundtrip', async () => {
    const doc = await client.subscribe('test-doc');
    doc.set('field', 'value');
    await doc.sync();
    
    // Verify via second client
  });

  test('awareness updates', async () => {
    const doc = await client.subscribe('awareness-test');
    client.setAwareness(doc.id, { cursor: { x: 100, y: 200 } });
    // Verify awareness reaches other clients
  });

  test('reconnection recovery', async () => {
    const doc = await client.subscribe('reconnect-test');
    doc.set('before', 'disconnect');
    await client.disconnect();
    await client.connect();
    // Verify state recovered
  });
});
```

## Validation Command

```bash
cd tests
SYNCKIT_SERVER_URL=ws://localhost:8080/ws bun test sdk/
```

## Acceptance Criteria

- [ ] SDK connects successfully
- [ ] Binary protocol works
- [ ] All SDK operations work
- [ ] Reconnection works
- [ ] No protocol errors

---

**Status:** ⬜ Not Started
