# V7-03: Run Integration Tests

> **Summary:** Run and pass all 244 integration tests covering auth, subscribe, delta, sync, awareness, reconnect, error handling, and end-to-end workflows against both TypeScript and C# server implementations.

[â† Back to Phase 7](README.md) | [Phase Document](../PHASE-7-TESTING.md)

---

**Priority:** P0  
**Estimate:** 8 hours  
**Dependencies:** V7-01

## Description

Run and pass all 244 integration tests against both server implementations to validate full protocol compatibility.

## Test Categories

| Category | Count | Description |
|----------|-------|-------------|
| Auth | 32 | JWT, API key, permissions |
| Subscribe | 28 | Document subscription flow |
| Delta | 45 | Delta sync and broadcast |
| Sync | 38 | Sync request/response |
| Awareness | 35 | Presence and cursors |
| Reconnect | 22 | Reconnection handling |
| Error | 24 | Error cases and recovery |
| E2E | 20 | Full workflow tests |

## Validation Commands

### Against TypeScript Server (baseline)

```bash
cd tests
bun test integration/
```

### Against C# Server

```bash
cd tests
TEST_SERVER_TYPE=csharp bun test integration/
```

### Against External Server

```bash
cd tests
SYNCKIT_SERVER_URL=ws://localhost:8080/ws bun test integration/
```

## Test Tracking

Track progress as you fix issues:

| Test File | Pass | Fail | Notes |
|-----------|------|------|-------|
| auth.test.ts | | | |
| subscribe.test.ts | | | |
| delta.test.ts | | | |

## Common Issues and Fixes

| Issue | Symptom | Fix |
|-------|---------|-----|
| Message ID format | Test expects specific format | Match TypeScript `nanoid()` |
| Timestamp precision | Off-by-one errors | Use Unix milliseconds |
| JSON casing | Property not found | Use camelCase |
| Array ordering | Wrong order in response | Match TypeScript order |

## Acceptance Criteria

- [ ] All 244 integration tests pass against TypeScript server (baseline)
- [ ] All 244 integration tests pass against C# server
- [ ] No test timeouts (>30s)
- [ ] Tests run in <5 minutes total per server
- [ ] No flaky tests
- [ ] Behavior matches between implementations

---

**Status:** â¬œ Not Started
