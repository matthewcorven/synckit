# V7-11: Connection Rate Limiting (Optional)

> **Summary:** Add configurable per-connection message rate limiting to protect against misbehaving clients - a .NET-specific security enhancement beyond the TypeScript reference.

[← Back to Phase 7](README.md) | [Phase Document](../PHASE-7-TESTING.md)

---

**Priority:** P2  
**Estimate:** 3 hours  
**Dependencies:** V7-03

## Description

Add per-connection message rate limiting to protect against misbehaving clients. This is an **enhancement beyond the TypeScript reference** implementation.

> **Note:** The TypeScript server does not implement per-connection rate limiting. This is a .NET-specific security enhancement.

## Implementation

```csharp
public class ConnectionRateLimiter
{
    private readonly int _maxMessagesPerSecond;
    private int _messageCount;
    private DateTime _windowStart;
    private readonly object _lock = new();

    public bool TryAcquire(string connectionId)
    {
        lock (_lock)
        {
            var now = DateTime.UtcNow;
            if ((now - _windowStart).TotalSeconds >= 1)
            {
                _windowStart = now;
                _messageCount = 0;
            }
            
            if (++_messageCount > _maxMessagesPerSecond)
            {
                return false;
            }
            
            return true;
        }
    }
}
```

## Configuration

```json
{
  "SyncKit": {
    "RateLimiting": {
      "Enabled": true,
      "MaxMessagesPerSecond": 100
    }
  }
}
```

## Acceptance Criteria

- [ ] Configurable rate limit per connection
- [ ] Graceful rejection with error message
- [ ] Rate limit logged for monitoring
- [ ] Can be disabled via configuration

---

**Status:** ⬜ Not Started
