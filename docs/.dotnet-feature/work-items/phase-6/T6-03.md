# T6-03: Add Database Migrations

> **Summary:** Set up database migration system for schema management with versioned migration scripts and automatic startup execution.

[← Back to Phase 6](README.md) | [Phase Document](../PHASE-6-STORAGE.md)

---

**Priority:** P0  
**Estimate:** 3 hours  
**Dependencies:** T6-02

## Description

Set up database migration system for schema management.

## Tasks

1. Create migrations folder structure
2. Implement migration runner
3. Create initial schema migration
4. Add startup migration execution

## Migration Structure

```
SyncKit.Server/
  Storage/
    Migrations/
      Scripts/
        001_initial_schema.sql
        002_add_indexes.sql
```

## Migration Interface

```csharp
public interface IMigrationRunner
{
    Task RunMigrationsAsync(CancellationToken ct = default);
}
```

## Features

- Migrations tracked in `schema_migrations` table
- Only unapplied migrations run
- Migrations run in alphabetical order by version
- Rollback on failure (transaction per migration)
- Startup execution via DI

## Acceptance Criteria

- [ ] Migrations tracked in database
- [ ] Only unapplied migrations run
- [ ] Migrations run in order
- [ ] Rollback on failure
- [ ] Startup migration execution

---

**Status:** ⬜ Not Started
